/*! VBuyApp 29-04-2016 */
app_retailer.factory("authInterceptorService",["$q","$injector","$location","localStorageService",function(a,b,c,d){var e={},f=function(a){a.headers=a.headers||{};var b=d.get("authorizationData");return b&&(a.headers.Authorization="Bearer "+b.token),a},g=function(e){if(401===e.status){var f=b.get("authService"),g=d.get("authorizationData");if(g&&g.useRefreshTokens)return c.path("/refresh"),a.reject(e);f.logOut(),c.path("/login")}return a.reject(e)};return e.request=f,e.responseError=g,e}]),app_retailer.factory("authService",["$rootScope","$http","$q","localStorageService",function(a,b,c,d){var e={},f={isAuth:!1,userName:"",useRefreshTokens:!1},g=function(a){var e="grant_type=password&username="+a.userName+"&password="+a.password,g=c.defer();return b.post("/VBuy/token",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){d.set("authorizationData",{token:b.access_token,userName:a.userName,refreshToken:"",useRefreshTokens:!1}),f.isAuth=!0,f.userName=a.userName,g.resolve(b)}).error(function(a){h(),g.reject(a)}),g.promise},h=function(){d.remove("authorizationData"),f.isAuth=!1,f.userName="",f.useRefreshTokens=!1,a.flagLoggedIn=!1},i=function(){var a=d.get("authorizationData");a&&(f.isAuth=!0,f.userName=a.userName,f.useRefreshTokens=a.useRefreshTokens)},j=function(){var a=c.defer(),e=d.get("authorizationData");if(e&&e.useRefreshTokens){var f="grant_type=";d.remove("authorizationData"),b.post(serviceBase+"token",f,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){d.set("authorizationData",{token:b.access_token,userName:b.userName,refreshToken:b.refresh_token,useRefreshTokens:!0}),a.resolve(b)}).error(function(b){_logOut(),a.reject(b)})}return a.promise},k=function(a){var e=c.defer();return b.get(serviceBase+"api/account/ObtainLocalAccessToken",{params:{provider:a.provider,externalAccessToken:a.externalAccessToken}}).success(function(a){d.set("authorizationData",{token:a.access_token,userName:a.userName,refreshToken:"",useRefreshTokens:!1}),f.isAuth=!0,f.userName=a.userName,f.useRefreshTokens=!1,e.resolve(a)}).error(function(a){_logOut(),e.reject(a)}),e.promise},l=function(a){var e=c.defer();return b.post(serviceBase+"api/account/registerexternal",a).success(function(a){d.set("authorizationData",{token:a.access_token,userName:a.userName,refreshToken:"",useRefreshTokens:!1}),f.isAuth=!0,f.userName=a.userName,f.useRefreshTokens=!1,e.resolve(a)}).error(function(a){_logOut(),e.reject(a)}),e.promise};return e.login=g,e.logOut=h,e.fillAuthData=i,e.authentication=f,e.refreshToken=j,e.obtainAccessToken=k,e.externalAuthData=i,e.registerExternal=l,e}]),app_retailer.service("ordersService",function(){var a="/VBuy/api/RetailerOrder";this.getPendingOrders=function(b,c,d,e,f){var g={headers:{CommandType:"GetPendingOrderHistory"},params:{branchId:d,PageSize:e,PageNo:f}};return c.get(a+"/GetPendingOrderHistory",g)},this.GetTotalOrders=function(b,c,d){var e={headers:{CommandType:"GetTotalOrders"},params:{branchId:d}};return c.get(a+"/GetTotalOrders",e)},this.getorders=function(b,c,d,e){var f={headers:{CommandType:"GetOrders"},params:{branchId:d,orderId:e}};return c.get(a+"/GetOrders",f)},this.getOrderSearch=function(b,c,d,e,f){var g={headers:{CommandType:"GetOrdersSearch"},params:{branchId:d,order:f,Status:e}};return c.get(a+"/GetOrdersSearch",g)},this.getOrdersSummary=function(b,c,d){var e={headers:{CommandType:"GetOrdersSummary"},params:{branchId:d}};return c.get(a+"/GetOrdersSummary",e)},this.getOrderSummaryByCategory=function(b,c,d){var e={headers:{CommandType:"GetOrderSummaryByCategory"},params:{branchId:d}};return c.get(a+"/GetOrderSummaryByCategory",e)},this.getOrderSummaryByProduct=function(b,c,d){var e={headers:{CommandType:"GetOrderSummaryByProduct"},params:{branchId:d}};return c.get(a+"/GetOrderSummaryByProduct",e)},this.getOrderCountByStatus=function(b,c,d){var e={headers:{CommandType:"GetOrderCountSplitByStatus"},params:{branchId:d}};return c.get(a+"/GetOrderCountSplitByStatus",e)},this.getLast7DaysSalesChart=function(b,c,d){var e={headers:{CommandType:"GetLast7DaysSalesChart"},params:{branchId:d}};return c.get(a+"/GetLast7DaysSalesChart",e)},this.getLast6MonthsSalesChart=function(b,c,d){var e={headers:{CommandType:"GetLast6MonthsSalesChart"},params:{branchId:d}};return c.get(a+"/GetLast6MonthsSalesChart",e)},this.getBranchProductSummary=function(b,c,d){var e={headers:{CommandType:"GetBranchProductSummary"},params:{branchId:d}};return c.get(a+"/GetBranchProductSummary",e)},this.getBranchEnquirySummary=function(b,c,d){var e={headers:{CommandType:"GetBranchEnquirySummary"},params:{branchId:d}};return c.get(a+"/GetBranchEnquirySummary",e)},this.getOrderStatus=function(b,c){var d={headers:{CommandType:"GetOrderStatus"}};return c.get(a+"/GetOrderStatus",d)},this.printOrderDetails=function(b,c){var d={headers:{CommandType:"PrintOrderDetails"},params:{orderId:c}};return b.get(a+"/PrintOrderDetails",d)},this.GetPaymentOption=function(b,c){var d={headers:{CommandType:"GetPaymentOption"}};return c.get(a+"/GetPaymentOption",d)},this.UpdateOrderStatus=function(b,c,d,e,f){var g={headers:{CommandType:"UpdateOrderStatus"}},h={subOrderId:d,orderId:e,statusId:f};return c.post(a+"/UpdateOrderStatus/",h,g)},this.UpdatePaymentStatus=function(b,c,d,e,f){var g={headers:{CommandType:"UpdateOrderStatus"}},h={subOrderId:d,orderId:e,statusId:f};return c.post(a+"/UpdateOrderStatus/",h,g)}}),app_retailer.service("passwordService",function(){var a="/VBuy/api/Login";this.forgotPassword=function(b,c,d){var e={params:{username:d}};return c.get(a+"/ForgotPassword",e)},this.resetPassword=function(b,c,d,e){var f={UserName:d,UniqueId:b.uid,Password:e},g={headers:{CommandType:"ResetPassword"}};return c.post(a+"/ResetPassword",f,g)},this.changePassword=function(b,c,d,e,f){var g={CurrentPassword:e,UserName:d,NewPassword:f},h={headers:{CommandType:"ChangePassword"}};return c.post(a+"/ChangePassword",g,h)}}),app_retailer.service("productService",function(){var a="/VBuy/api/Retailer";this.getProductSpecification=function(b,c,d){var e={params:{productId:d}};return c.get(a+"/GetProductSpecification/",e)},this.getProductKeyFeatures=function(b,c,d){var e={params:{productId:d}};return c.get(a+"/GetProductKeyFeatures/",e)},this.getProductFilterValues=function(b,c,d){var e={params:{productId:d}};return c.get(a+"/GetProductFilterValues/",e)},this.getFiltersForProductCategory=function(b,c,d){var e={params:{productId:d}};return c.get(a+"/GetFiltersForProductCategory/",e)},this.updateProductSpecifications=function(b,c,d,e,f,g){var g={productFilters:e,productKeyFeatures:f,productSpecifications:g},h={headers:{CommandType:"UpdateProductSpecifications"}};return c.post(a+"/UpdateProductSpecifications/",g,h)},this.getProductById=function(b,c,d){var e={params:{id:d}};return c.get(a+"/GetProductById/",e)},this.updateProduct=function(b,c,d){var e={headers:{CommandType:"UpdateProduct"}};return c.post(a+"/UpdateProduct",d,e)},this.updateProductSeo=function(b,c,d){var e={headers:{CommandType:"UpdateProductSEO"}};return c.post(a+"/UpdateProductSEO",d,e)}}),app_retailer.service("retailerServiceNew",function(){var a="/VBuy/api/Landing",b="/VBuy/api/Login";this.RegisterRetailer=function(a,c,d){var e={headers:{CommandType:"RegisterRetailer"}};return c.post(b+"/RegisterRetailer",d,e).then(function(a){return a})},this.getAppData=function(b){var c={headers:{CommandType:"GetApplicationData"}};return b.get(a+"/GetApplicationData",c).then(function(a){return a})}}),app_retailer.service("storesService",function(){var a="/VBuy/api/Retailer";this.getFilter=function(b){var c={headers:{CommandType:"GetRetailerProductFilter"}};return b.get(a+"/GetRetailerProductFilter",c)},this.getProducts=function(b,c){var d={headers:{CommandType:"GetProducts"},params:b.filters};return c.get(a+"/GetProducts",d)},this.productPagination=function(b,c,d,e){var f={headers:{CommandType:"GetPagingProducts"},params:{selectedCategory:b.filters.selectedCategory,selectedSubCategory:b.filters.selectedSubCategory,selectedBrand:b.filters.selectedBrand,pageNo:d,PageSize:e}};return c.get(a+"/GetPagingProducts",f)},this.getMyFilteredProducts=function(b,c,d){b.filters.storeId=b.RetailerInfo.StoreId,b.filters.selectedBranchId=d;var e={headers:{CommandType:"GetMyProducts"},params:b.filters};return c.get(a+"/GetMyProducts",e)},this.getMyFilteredProductsPaging=function(b,c,d,e){var f={headers:{CommandType:"GetMyFilteredProductsPaging"},params:{selectedCategory:b.filters.selectedCategory,selectedSubCategory:b.filters.selectedSubCategory,selectedBranchId:b.filters.selectedBranchId,storeId:b.RetailerInfo.StoreId,pageNo:d,selectedBrand:b.filters.selectedBrand,PageSize:e}};return c.get(a+"/GetMyFilteredProductsPaging",f)},this.getRetailerInfo=function(b){var c={headers:{CommandType:"GetRetailerInfo"}};return b.get(a+"/GetRetailerInfo",c)},this.includeProduct=function(b,c,d){var e={headers:{CommandType:"IncludeProducts"}};return c.post(a+"/IncludeProducts",d,e)},this.createProduct=function(b,c,d){var e={headers:{CommandType:"IncludeProducts"}};return c.post(a+"/CreateProduct",d,e)},this.updatePrice=function(b,c,d){d.StoreId=b.RetailerInfo.StoreId,d.BranchIdList=[],d.BranchIdList.push(b.filters.selectedBranchId);var e={headers:{CommandType:"UpdateProductPrice"}};return c.post(a+"/UpdateProductPrice",d,e)},this.removeProduct=function(b,c,d){d.StoreId=b.RetailerInfo.StoreId,d.BranchIdList=[],d.BranchIdList.push(b.filters.selectedBranchId);var e={headers:{CommandType:"RemoveProduct"}};return c.post(a+"/RemoveProduct",d,e)},this.resumeProduct=function(b,c,d){d.StoreId=b.RetailerInfo.StoreId,d.BranchIdList=[],d.BranchIdList.push(b.filters.selectedBranchId);var e={headers:{CommandType:"ResumeProduct"}};return c.post(a+"/ResumeProduct",d,e)},this.getMyDetails=function(b,c,d){var e={params:{username:d}};return c.get(a+"/GetMyDetails",e)},this.getInbox=function(b,c,d){var e={params:{storeId:d}};return c.get(a+"/GetSellerInbox",e)},this.InboxReply=function(b,c,d,e){var f={params:{mailId:d,reply:e}};return c.get(a+"/InboxReply",f)},this.getStoreDetails=function(b,c,d,e){var f={params:{username:d,branchId:e},headers:{CommandType:"UpdateFilterParameters"}};return c.get(a+"/GetStoreDetails",f)},this.updateBranchDetails=function(b,c,d,e){var f={branch:e,userName:d},g={headers:{CommandType:"UpdateBranchDetails"}};return c.post(a+"/UpdateBranchDetails/",f,g)},this.createNewBranch=function(b,c,d,e){e.BranchId=0;var f={branch:e,userName:d},g={headers:{CommandType:"CreateNewBranch"}};return c.post(a+"/CreateNewBranch/",f,g)}});